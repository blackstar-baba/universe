"use strict";(self.webpackChunkblackstar_universe=self.webpackChunkblackstar_universe||[]).push([[5305],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),s=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=s(e.components);return r.createElement(c.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=s(t),m=a,b=u["".concat(c,".").concat(m)]||u[m]||d[m]||i;return t?r.createElement(b,l(l({ref:n},p),{},{components:t})):r.createElement(b,l({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,l=new Array(i);l[0]=u;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<i;s++)l[s]=t[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5072:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>s});var r=t(7462),a=(t(7294),t(3905));const i={},l=void 0,o={unversionedId:"StarRocks/build",id:"StarRocks/build",title:"build",description:"description",source:"@site/docs/StarRocks/build.md",sourceDirName:"StarRocks",slug:"/StarRocks/build",permalink:"/docs/StarRocks/build",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"be_remote_debug",permalink:"/docs/StarRocks/be_remote_debug"},next:{title:"cbo",permalink:"/docs/StarRocks/cbo"}},c={},s=[{value:"description",id:"description",level:2},{value:"link",id:"link",level:2}],p={toc:s};function d(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"description"},"description"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"dockerfile")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dockerfile"},'FROM centos:7 AS builder\n\n\n# //todo need ccache\n\n# install dependencies\nRUN yum makecache && yum -y update && yum -y groupinstall \'Development Tools\' && \\\n    yum install -y byacc automake java-11-openjdk-devel java-1.8.0-openjdk-devel libtool bison binutils-devel zip \\\n    unzip ncurses-devel curl git wget python2 python3 glibc-static java-1.8.0-openjdk-devel \\\n    libstdc++-static which psl libpsl-devel centos-release-scl && \\\n    yum install -y devtoolset-10 devtoolset-10-gcc devtoolset-10-libubsan-devel devtoolset-10-liblsan-devel \\\n    devtoolset-10-libasan-devel\n    \n# build cmake\nARG CMAKE_VERSION=3.19.8\nARG CMAKE_BASE_URL=https://github.com/Kitware/CMake/releases/download/v${CMAKE_VERSION}\nRUN wget ${CMAKE_BASE_URL}/cmake-${CMAKE_VERSION}-Linux-x86_64.sh -q -O /tmp/cmake-install.sh && \\\n    chmod u+x /tmp/cmake-install.sh && \\\n    /tmp/cmake-install.sh --skip-license --prefix=/usr --exclude-subdir && \\\n    rm /tmp/cmake-install.sh\n\n# build gcc\nARG GCC_VERSION=10.3.0\nARG GCC_URL=https://mirrors.ustc.edu.cn/gnu/gcc/gcc-${GCC_VERSION}\n\nRUN yum install -y gcc-c++ \\\n  && mkdir -p  /var/local/gcc \\\n  && curl -fsSL -o /tmp/gcc.tar.gz  ${GCC_URL}/gcc-${GCC_VERSION}.tar.gz \\\n  && tar -xvf /tmp/gcc.tar.gz -C /var/local/gcc --strip-components=1 \\\n  && cd /var/local/gcc \\\n  && sed -i \'s/ftp:\\/\\/gcc.gnu.org\\/pub\\/gcc\\/infrastructure\\//http:\\/\\/mirror.linux-ia64.org\\/gnu\\/gcc\\/infrastructure\\//g\' contrib/download_prerequisites \\\n  && ./contrib/download_prerequisites \\\n  && ./configure --disable-multilib --enable-languages=c,c++ --prefix=/usr \\\n  && make -j$[$(nproc)/4+1] && make install \\\n  && rm -rf /var/local/gcc \\\n  && rm -f /tmp/gcc.tar.gz\n\n# build  ninja\nARG NINJA_VER=1.10.2\nARG NINJA_BASE_URL=https://github.com/ninja-build/ninja/releases/download/v${NINJA_VER}\nRUN wget -q ${NINJA_BASE_URL}/ninja-linux.zip -O /tmp/ninja-linux.zip && \\\n    unzip /tmp/ninja-linux.zip -d /usr/bin/ && \\\n    rm /tmp/ninja-linux.zip\n\n# install maven 3.6.3\nARG MAVEN_VERSION=3.6.3\nARG MAVEN_BASE_URL=https://downloads.apache.org/maven/maven-3/${MAVEN_VERSION}/binaries\nRUN mkdir -p /usr/share/maven /usr/share/maven/ref && \\\n    wget -q -O /tmp/apache-maven.tar.gz ${MAVEN_BASE_URL}/apache-maven-${MAVEN_VERSION}-bin.tar.gz && \\\n    tar -xzf /tmp/apache-maven.tar.gz -C /usr/share/maven --strip-components=1 && \\\n    rm -f /tmp/apache-maven.tar.gz && \\\n    ln -s /usr/share/maven/bin/mvn /usr/bin/mvn\n\n# build flex\nARG FLEX_VERSION=2.6.4\nRUN wget https://github.com/westes/flex/releases/download/v$FLEX_VERSION/flex-$FLEX_VERSION.tar.gz \\\n    -q -O /tmp/flex-$FLEX_VERSION.tar.gz \\\n    && cd /tmp/ \\\n    && tar -xf flex-$FLEX_VERSION.tar.gz \\\n    && cd flex-$FLEX_VERSION \\\n    && ./configure --enable-shared=NO \\\n    && make \\\n    && make install \\\n    && rm /tmp/flex-$FLEX_VERSION.tar.gz \\\n    && rm -rf /tmp/flex-$FLEX_VERSION\n\n# install nodejs\nARG NODEJS_VERSION=14.16.0\nRUN wget https://nodejs.org/dist/v$NODEJS_VERSION/node-v$NODEJS_VERSION-linux-x64.tar.gz \\\n    -q -O /tmp/node-v$NODEJS_VERSION-linux-x64.tar.gz \\\n    && cd /tmp/ && tar -xf node-v$NODEJS_VERSION-linux-x64.tar.gz \\\n    && cp -r node-v$NODEJS_VERSION-linux-x64/* /usr/local/ \\\n    && rm /tmp/node-v$NODEJS_VERSION-linux-x64.tar.gz && rm -rf node-v$NODEJS_VERSION-linux-x64\n\n\nENV BASH_ENV=/opt/rh/devtoolset-10/enable  \\\n    ENV=/opt/rh/devtoolset-10/enable  \\\n    PROMPT_COMMAND=". /opt/rh/devtoolset-10/enable"\n\n# there is a repo which is included all of thirdparty\nENV REPOSITORY_URL=https://doris-thirdparty-repo.bj.bcebos.com/thirdparty\nENV DEFAULT_DIR=/var/local\nENV JAVA_HOME=/usr/lib/jvm/java-1.8.0\n# ENV JAVA_HOME="/usr/lib/jvm/java-11"\n\n# clone lastest source code, download and build third party\n# COPY incubator-doris ${DEFAULT_DIR}/incubator-doris\n# RUN cd ${DEFAULT_DIR}/incubator-doris && /bin/bash thirdparty/build-thirdparty.sh \\\n#    && rm -rf ${DEFAULT_DIR}/incubator-doris/thirdparty/src \\\n#    && rm -rf ${DEFAULT_DIR}/doris-thirdparty.tar.gz \\\n#    && rm -rf ${DEFAULT_DIR}/doris-thirdparty \\\n#    && mkdir -p ${DEFAULT_DIR}/thirdparty \\\n#    && mv ${DEFAULT_DIR}/incubator-doris/thirdparty/installed ${DEFAULT_DIR}/thirdparty/ \\\n#    && rm -rf ${DEFAULT_DIR}/incubator-doris\n\n# RUN alternatives --set java java-11-openjdk.x86_64 && alternatives --set javac java-11-openjdk.x86_64\n\n\nFROM scratch\n\nCOPY --from=builder / /\n# ENV JAVA_HOME="/usr/lib/jvm/java-11" \\\nENV JAVA_HOME="/usr/lib/jvm/java-8" \\\n    MAVEN_HOME="/usr/share/maven" \\\n    BASH_ENV="/opt/rh/devtoolset-10/enable" \\\n    ENV="/opt/rh/devtoolset-10/enable"  \\\n    PROMPT_COMMAND=". /opt/rh/devtoolset-10/enable" \\\n    REPOSITORY_URL="https://doris-thirdparty-repo.bj.bcebos.com/thirdparty" \\\n    DEFAULT_DIR="/var/local" \\\n    PATH="/var/local/thirdparty/installed/bin:$PATH" \\\n    DORIS_THIRDPARTY="/var/local/thirdparty"\nWORKDIR /root\n\nCMD ["/bin/bash"]\n\n\n')),(0,a.kt)("h2",{id:"link"},"link"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://ftp.gnu.org/gnu/gcc/gcc-10.3.0/"},"gcc download")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://lolipopj.github.io/2021/04/19/linux-docker-gcc-update/#/%E4%B8%8B%E8%BD%BD-GCC-%E4%BE%9D%E8%B5%96%E5%8C%85"},"gcc update"))))}d.isMDXComponent=!0}}]);